# 🧩 슈퍼타입–서브타입 테이블 병합 (반정규화)

## 📘 개념 요약

* **반정규화(Denormalization)**: 정규화된 테이블 구조를 일부 다시 합쳐 **조회 성능을 높이기 위한 설계 기법**
* **적용 이유**: 조인(Join) 연산이 많아질수록 조회 속도가 느려지기 때문
* **핵심 포인트**: *조회 성능 향상*이 주 목적 (쓰기 성능이나 저장공간은 부차적)

---

## 🧱 슈퍼타입과 서브타입

* **슈퍼타입(Super Type)**: 공통 속성을 가진 상위 개체
* **서브타입(Sub Type)**: 슈퍼타입의 속성을 상속받아 특화된 개체
* 예시

  * 슈퍼타입: 사건(Event)
  * 서브타입: 긴급사건 / 특수사건 / 일반사건
* ERD 형태

  ```
  사건
   ├─ 긴급사건
   ├─ 특수사건
   └─ 일반사건
  ```

---

## 🧮 반정규화(테이블 병합)의 필요성

| 구분 | 설명                              |
| -- | ------------------------------- |
| 목적 | 조회 성능 향상                        |
| 이유 | 조인 연산은 CPU 부하 ↑, 시간복잡도 O(n²) 수준 |
| 대상 | 슈퍼타입–서브타입 구조에서 조회 패턴에 따라 병합     |

---

## 🔀 병합 방식 3가지

### 1️⃣ **원투원 타입 (One-to-One Type)**

* 슈퍼타입과 각 서브타입을 **그대로 분리 유지**
* 각 서브타입이 **독립적인 트랜잭션**을 가질 때 적합
* 즉, **개별 조회가 많고 함께 조회할 일이 적을 때**

💡 예시

> 긴급사건만 자주 조회하고, 전체 사건을 함께 볼 일은 거의 없음

---

### 2️⃣ **플러스 타입 (Plus Type)**

* **각 서브타입에 슈퍼타입 컬럼을 중복 저장**
* 조인이 필요 없음 (조회 빠름)
* 단, **데이터 중복 발생**

💡 예시

> 특수사건 테이블에 “사건ID, 등록일, 담당자(슈퍼 속성)”이 이미 포함되어 있음

| 장점     | 단점                 |
| ------ | ------------------ |
| 조회 빠름  | 데이터 중복             |
| 조인 불필요 | 수정 시 여러 테이블 동기화 필요 |

---

### 3️⃣ **싱글 타입 (Single / All-in-one Type)**

* **모든 슈퍼 + 서브타입 데이터를 한 테이블에 통합**
* 사건 분류 코드(`사건_분류코드`) 추가하여 구분
* 대부분의 조회가 “전체 사건” 단위로 이뤄질 때 적합

💡 예시

> 사건 테이블 하나에 긴급/특수/일반 사건이 모두 저장되어 있고, `분류코드`로 구분됨

| 장점              | 단점               |
| --------------- | ---------------- |
| 조인 없음 → 성능 최고   | 불필요한 컬럼 다수 존재 가능 |
| 조회가 단일 테이블에서 끝남 | 관리 복잡도 증가        |

---

## ⚙️ 선택 기준 요약

| 조회 형태                     | 추천 타입    |
| ------------------------- | -------- |
| 서브타입별 독립적 조회              | ✅ 원투원 타입 |
| 슈퍼+서브 함께 자주 조회 (중복 허용 가능) | ✅ 플러스 타입 |
| 항상 전체를 함께 조회              | ✅ 싱글 타입  |

---

## 🧠 성능 개념 정리

* **조인 / 유니온** 연산은 `O(n²)` 복잡도 수준
* 데이터가 2배 늘면 연산량은 4배 증가
* ⇒ CPU 부하 ↑, 응답시간 ↓
* 반정규화는 이를 줄이기 위한 “속도 vs 중복” 트레이드오프

---

## 🎯 시험 포인트

* “**대부분 함께 조회한다**” → **싱글 타입**
* “**서브타입별로 별도 관리한다**” → **원투원 타입**
* “**항상 슈퍼 정보도 함께 필요하다**” → **플러스 타입**

---

## 📌 핵심 정리 문장

> 반정규화는 **조회 성능을 높이기 위한 구조적 트레이드오프**이며,
> 슈퍼타입–서브타입 병합에는 **원투원, 플러스, 싱글** 세 가지 방식이 있다.

---
