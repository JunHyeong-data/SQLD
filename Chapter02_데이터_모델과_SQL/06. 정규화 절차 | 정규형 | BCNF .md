# 📘 데이터베이스 정규화 (Normalization)

## 1️⃣ 정규화란?

**정규화(Normalization)**는 데이터베이스를 설계할 때 **이상 현상(Anomaly)**을 방지하고 **데이터의 중복을 최소화**하여 **데이터를 체계적으로 조직화하는 과정**이다.

---

## 2️⃣ 이상 현상(Anomaly)

정규화를 하지 않으면 다음과 같은 문제가 발생한다:

| 종류                        | 설명                                  |
| ------------------------- | ----------------------------------- |
| 삽입 이상 (Insertion Anomaly) | 새로운 데이터를 넣을 때 불필요한 데이터까지 입력해야 하는 문제 |
| 갱신 이상 (Update Anomaly)    | 일부 데이터만 수정되어 데이터 불일치가 생기는 문제        |
| 삭제 이상 (Deletion Anomaly)  | 한 데이터를 지울 때 관련된 다른 정보까지 같이 사라지는 문제  |

---

## 3️⃣ 정규화의 목적

* **이상 현상 방지**
* **데이터 중복 최소화**
* **데이터 무결성 향상**
* **시스템 전체 성능 향상 (트랜잭션 감소)**

> ⚠️ 주의: 정규화는 테이블을 분리하기 때문에 **조인(Join) 횟수가 증가**하며,
> 이로 인해 **조회 성능은 다소 하락**할 수 있다.
> 하지만 **전체 시스템 성능은 향상**될 수 있다 (불필요한 락, 트랜잭션 감소 때문).

---

## 4️⃣ 정규화의 단계 (정규형, Normal Form)

| 단계      | 이름        | 핵심 개념                                            |
| ------- | --------- | ------------------------------------------------ |
| 1NF     | 제1정규형     | **모든 속성이 원자값(atomic value)**만 가져야 함              |
| 2NF     | 제2정규형     | **부분적 함수 종속성 제거** (복합키의 일부에만 종속된 속성 제거)          |
| 3NF     | 제3정규형     | **이행적 함수 종속성 제거** (일반 속성이 또 다른 일반 속성에 종속된 경우 제거) |
| BCNF    | 보이스코드 정규형 | **후보키가 아닌 결정자가 존재할 경우 분리**                       |
| 4NF~5NF | 고급 정규화    | 다치 종속, 조인 종속 문제 해결 (SQLEd에서는 거의 출제되지 않음)         |

---

## 5️⃣ 제1정규화 (1NF)

**모든 속성이 원자값만 가져야 한다.**

* 한 컬럼(속성)에 여러 값이 들어가면 안 됨.
* 유사한 속성이 반복되는 경우 테이블을 분리해야 함.

### ❌ 잘못된 예시

| 물류센터코드 | 재고일자       | 1개월수량 | 2개월수량 | 1개월금액 | 2개월금액 |
| ------ | ---------- | ----- | ----- | ----- | ----- |
| A001   | 2025-01-01 | 30    | 50    | 3000  | 5000  |

→ 유사한 속성(`1개월수량`, `2개월수량`)이 반복됨.

### ✅ 정규화 후

**1제고(Parent)**

| 물류센터코드 | 재고일자       |
| ------ | ---------- |
| A001   | 2025-01-01 |

**1제고상세(Child)**

| 물류센터코드 | 재고일자       | 재고기간 | 수량 | 금액   |
| ------ | ---------- | ---- | -- | ---- |
| A001   | 2025-01-01 | 1개월  | 30 | 3000 |
| A001   | 2025-01-01 | 2개월  | 50 | 5000 |

> 두 테이블은 **1대다(1:N)** 관계가 된다.

---

## 6️⃣ 제2정규화 (2NF)

**복합 기본키의 일부에만 종속된 속성을 분리한다.**

> 즉, “기본키 전체가 아닌 일부에 의존하는 일반 속성이 있을 때” 분리해야 함.

---

## 7️⃣ 제3정규화 (3NF)

**일반 속성이 다른 일반 속성에 종속될 때 분리한다.**

예를 들어,
`학번 → 학과코드`,
`학과코드 → 학과명`이면,
`학번 → 학과명`은 **이행적 함수 종속**이므로 분리해야 한다.

---

## 8️⃣ BCNF (Boyce-Codd Normal Form)

**후보키가 아닌 결정자(Determinant)**가 존재할 경우 다시 분리한다.

예시:

```
강사 → 과목
(한 강사는 하나의 과목만 담당)
```

이 경우 `강사`가 `과목`을 결정하지만 `강사`는 기본키가 아님 → BCNF 분해 필요.

---

## 9️⃣ 정규화와 성능 요약

| 구분    | 효과                              |
| ----- | ------------------------------- |
| 장점    | 이상현상 방지, 데이터 무결성 확보, 시스템 안정성 향상 |
| 단점    | 조인(Join) 증가로 인해 조회 성능 저하 가능     |
| 전체 효과 | **트랜잭션 감소로 시스템 전체 성능 향상 가능**    |

---

## 🔟 용어 정리

| 용어                     | 뜻                                     |
| ---------------------- | ------------------------------------- |
| **함수적 종속성 (FD)**       | 속성 X의 값이 주어지면 속성 Y의 값이 유일하게 결정됨 (X→Y) |
| **결정자(Determinant)**   | 다른 속성을 결정하는 속성                        |
| **후보키(Candidate Key)** | 기본키가 될 수 있는 속성 집합                     |
| **기본키(Primary Key)**   | 테이블 내에서 행(Row)을 유일하게 식별하는 속성          |

---
